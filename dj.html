<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>DJ Controller - Adam Piekarski</title>

    <!-- Bootstrap core CSS -->
    <link href="css/bootstrap.min.css" rel="stylesheet">
    <!-- Custom styles for this template -->
    <link href="carousel.css" rel="stylesheet">

    <style>
    .carousel-inner > .item {
    background: url('assets/dj/header.jpg') no-repeat center center fixed;
    -webkit-background-size: cover;
    -moz-background-size: cover;
    -o-background-size: cover;
    background-size: cover;
    }
    </style>

  </head>
<!-- NAVBAR
================================================== -->
  <body>
  <a name="toptop"></a>
    <div class="navbar-wrapper">
        <nav class="navbar navbar-inverse navbar-fixed-top">
          <div class="container-fluid">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              <a class="navbar-brand" href="#">Adam Piekarski</a>
            </div>

            <div id="navbar" class="navbar-collapse collapse">
              <ul class="nav navbar-nav">
                <li><a href="index.html">Home</a></li>
                <li class="dropdown active">
                  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Projects<span class="caret"></span></a>
                  <ul class="dropdown-menu" role="menu">
                    <li class="dropdown-header">Hardware</li>
                    <li><a href="kettle.html">WiFi Kettle</a></li>
                    <li><a href="camera.html">35mm Pinhole camera</a></li>
                    <li><a href="amp.html">LM3886 Chip Amp (Gainclone)</a></li>
                    <li><a href="boombox.html">Boombox</a></li>
                    <li><a href="#">DJ Controller</a></li>
                    <li><a href="amp2.html">Dual mono LM3886 chip amp</a></li>
                    
                    <li class="divider"></li>
                    <li class="dropdown-header">Software</li>
                    <li><a href="piggy.html">Piggy Fly</a></li>
                    <li><a href="ceefax.html">Ceefax 2015</a></li>
                    <li><a href="teapot.html">Facebook Status Extension</a></li>
                    <li><a href="ear.html">Eardentity</a></li>
                  </ul>
                </li>
                <li><a href="index.html#about">About</a></li>
                <li><a href="index.html#contact">Contact</a></li>
                
              </ul>
            </div>


          </div>


        </nav>

      
    </div>


    <!-- Carousel
    ================================================== -->
    <div id="myCarousel" class="carousel slide" data-ride="carousel">
      <!-- Indicators -->

      <div class="carousel-inner" role="listbox">
        <div class="item active">
          
          <div class="container">
            <div class="carousel-caption">
              <h1>DJ Controller</h1>
              <p>A very compact Arduino based DJ Controller</p>
            </div>
          </div>
        </div>

      </div>

    </div><!-- /.carousel -->


    <!-- Marketing messaging and featurettes
    ================================================== -->
    <!-- Wrap the rest of the page in another container to center all the content. -->

    <div class="container marketing">


      <!-- START THE FEATURETTES -->
      <hr class="divider">
      <h1 class="featurette-title">How I made it:</h1>
      <hr class="divider">

      <div class="row featurette">
        <div class="col-md-7">
			<h2 class="featurette-heading">The enclosure</h2>
			<p class="lead">I had a couple of these nuts and bolts storage boxes lying around and they seemed to be the perfect size for this tiny beast.</p>

        </div>
        <div class="col-md-5">
          <img class="featurette-image img-responsive center-block" height="500" width="500" src="assets/dj/1.jpg" alt="Generic placeholder image">
        </div>
      </div>
      <hr class="featurette-divider">

      <div class="row featurette">
        <div class="col-md-7">
			<h2 class="featurette-heading">Drilling out the component holes</h2>
			<p class="lead">Drilled out three different types of holes for the potentiometers, push buttons and LED's. A bonus hole right at the back for the mini-USB port required to hook the thing up!</p>

        </div>
        <div class="col-md-5">
          <img class="featurette-image img-responsive center-block" height="500" width="500" src="assets/dj/3.jpg" alt="Generic placeholder image">
        </div>
      </div>
      <hr class="featurette-divider">

      <div class="row featurette">
        <div class="col-md-7">
			<h2 class="featurette-heading">Dry fit</h2>
			<p class="lead">Testing if all the components will fit in their predetermined holes.</p>

        </div>
        <div class="col-md-5">
          <img class="featurette-image img-responsive center-block" height="500" width="500" src="assets/dj/4.jpg" alt="Generic placeholder image">
        </div>
      </div>
      <hr class="featurette-divider">

      <div class="row featurette">
        <div class="col-md-7">
			<h2 class="featurette-heading">The brains</h2>
			<p class="lead">An Arduino Nano clone provides the interface between the PC and the physical device. With 14 digital and 10 analogue pins -  every component can be connected directly to the microcontroller.</p>

        </div>
        <div class="col-md-5">
          <img class="featurette-image img-responsive center-block" height="500" width="500" src="assets/dj/6-1.jpg" alt="Generic placeholder image">
        </div>
      </div>
      <hr class="featurette-divider">

      <div class="row featurette">
        <div class="col-md-7">
			<h2 class="featurette-heading">Quick schematics</h2>
			<p class="lead">The top left describes how the potentiometers are connected to nano - The GPIO will read a voltage between 0-5V and convert this into a digital value between 0-1023.</p>
			<p class="lead">The top right shows the push button - when open the 5V supply will go straight to ground through a 10K resistor, when pressed, current flows straight through to an input pin on the nano which we can read.</p>
			<p class="lead">The bottom schematic is an LED connected to a current limiting resistor - 220Î© was chosen. Since it is connected to a GPIO pin it can be switched on and off on command.</p>

        </div>
        <div class="col-md-5">
          <img class="featurette-image img-responsive center-block" height="500" width="500" src="assets/dj/4-1.jpg" alt="Generic placeholder image">
        </div>
      </div>
      <hr class="featurette-divider">
      
      <div class="row featurette">
        <div class="col-md-7">
			<h2 class="featurette-heading">The push button</h2>
			<p class="lead">An example push button wired up, ready to be placed in the enclosure and connected to the nano.</p>

        </div>
        <div class="col-md-5">
          <img class="featurette-image img-responsive center-block" height="500" width="500" src="assets/dj/5.jpg" alt="Generic placeholder image">
        </div>
      </div>
      <hr class="featurette-divider">

      <div class="row featurette">
        <div class="col-md-7">
			<h2 class="featurette-heading">All components in place</h2>
			<p class="lead">The potentiometers are all held in place using a nut, whereas the push buttons and LED's had to be secured using hot glue. I hate hot glue.</p>
			<p class="lead">The Arduino Nano sits in the centre of the case, wedged between the sides.</p>

        </div>
        <div class="col-md-5">
          <img class="featurette-image img-responsive center-block" height="500" width="500" src="assets/dj/6-2.jpg" alt="Generic placeholder image">
        </div>
      </div>
      <hr class="featurette-divider">

      <div class="row featurette">
        <div class="col-md-7">
			<h2 class="featurette-heading">Mess in progress</h2>
			<p class="lead">There are a lot of wires to deal with in a very small space.</p>

        </div>
        <div class="col-md-5">
          <img class="featurette-image img-responsive center-block" height="500" width="500" src="assets/dj/7.jpg" alt="Generic placeholder image">
        </div>
      </div>
      <hr class="featurette-divider">

      <div class="row featurette">
        <div class="col-md-7">
			<h2 class="featurette-heading">Finished wiring</h2>
			<p class="lead">Very messy!</p>

        </div>
        <div class="col-md-5">
          <img class="featurette-image img-responsive center-block" height="500" width="500" src="assets/dj/8.jpg" alt="Generic placeholder image">
        </div>
      </div>
      <hr class="featurette-divider">

      <div class="row featurette">
        <div class="col-md-7">
			<h2 class="featurette-heading">Nearly finished</h2>
			<p class="lead">Everything is connected and enclosed but the knobs and buttons aren't fun to press!</p>

        </div>
        <div class="col-md-5">
          <img class="featurette-image img-responsive center-block" height="500" width="500" src="assets/dj/9.jpg" alt="Generic placeholder image">
        </div>
      </div>
      <hr class="featurette-divider">

      <div class="row featurette">
        <div class="col-md-7">
			<h2 class="featurette-heading">Finished article</h2>
			<p class="lead">Stuck some arcade style buttons on and brushed aluminium knobs onto two of the pots.</p>

        </div>
        <div class="col-md-5">
          <img class="featurette-image img-responsive center-block" height="500" width="500" src="assets/dj/11.jpg" alt="Generic placeholder image">
        </div>
      </div>
      <hr class="featurette-divider">

      <div class="row featurette">
        <div class="col-md-7">
			<h2 class="featurette-heading">Beauty shot</h2>

        </div>
        <div class="col-md-5">
          <img class="featurette-image img-responsive center-block" height="500" width="500" src="assets/dj/12.jpg" alt="Generic placeholder image">
        </div>
      </div>
      <hr class="featurette-divider">

      <div class="row featurette">
        <div class="col-md-7">
			<h2 class="featurette-heading">Finished</h2>

        </div>
        <div class="col-md-5">
          <img class="featurette-image img-responsive center-block" height="500" width="500" src="assets/dj/13.jpg" alt="Generic placeholder image">
        </div>
      </div>
      <hr class="featurette-divider">

      <div class="row featurette">
        <div class="col-md-7">
			<h2 class="featurette-heading">Finished</h2>
			<p class="lead">The plan was to build a very cheap and portable DJ Controller.</p>
			<p class="lead">The result - three potentiometers, six push buttons and four LED's which are all user configurable.</p>

        </div>
        <div class="col-md-5">
          <img class="featurette-image img-responsive center-block" height="500" width="500" src="assets/dj/0.jpg" alt="Generic placeholder image">
        </div>
      </div>
      <hr class="featurette-divider">

      <hr class="divider">
      <h1 class="featurette-title">The Sofware</h1>
      <hr class="divider">

      <div class="row featurette">
        <div>
			<h2 class="featurette-heading">Arduino code</h2>
			<p class="lead">I quickly hacked together some Arduino code to read all the inputs and send changes as MIDI commands over the USB port (serial). The <a href="assets/dj/dj.ino">code</a> is as follows:</p>
			</div>
			<div>
			<p>
			<pre>
			<code>
// Based on http://www.instructables.com/id/Easy-3-Pot-Potentiometer-Arduino-Uno-Effects-Midi-/step4/The-Code/

// Current and previous value of all three potentionmeters
int pots[3][2] = { {0,0}, {0,0}, {0,0} };

// All button states (1 = has been pressed down, 0 = released/not pressed)
int state[6] = {0,0,0,0,0,0};

void setup() {
   Serial.begin(57600); // Set the speed of the midi port to the same as we will be using in the Hairless Midi software 
   digitalWrite(3,HIGH);
   digitalWrite(4,HIGH);
   digitalWrite(5,HIGH);
   digitalWrite(6,HIGH);
}

void loop() {
  // Left bass
  handlePot(3,1);

  // Right bass
  handlePot(6,2);

  // Crossfader
  handlePot(5,3);

  //left white
  handleButt(9,0);
  //left red
  handleButt(8,1);
  //left blue
  handleButt(7,2);

  // right blue
  handleButt(12,3);
  //right red
  handleButt(10,4);
  //right white
  handleButt(11,5);
    
  delay(10); //here we add a short delay to help prevent slight fluctuations, knocks on the pots etc. Adding this helped to prevent my pots from jumpin up or down a value when slightly touched or knocked.
}

// Sends a MIDI message to control channel "number" on any pot change on physical "pin"
inline void handlePot(int pin, int number) {
     pots[number-1][0] = (1023-analogRead(pin))/8;   // inverse value and decrese
      if (pots[number-1][0] != pots[number-1][1]) { // Only send if change
          MIDImessage(176,number,pots[number-1][0]); // 176 = CC command (channel 1 control change), 1 = Which Control, val = value read from Potentionmeter 1
      }         
      pots[number-1][1] = pots[number-1][0];
}

// Sends a MIDI message to "number" for any full press on physical "pin"
inline void handleButt(int pin, int number) {
  if (digitalRead(pin) == HIGH) {
    state[number] = 1;

   } else {
    if(state[number] == 1) {
      MIDImessage(144,number,127);
      state[number] = 0;
    }
   }
}

void MIDImessage(byte command, byte data1, byte data2) //pass values out through standard Midi Command
{
   Serial.write(command);
   Serial.write(data1);
   Serial.write(data2);
}
			</code></pre></p>
			</div>
        
      </div>
      <hr class="featurette-divider">

      <div class="row featurette">
        <div class="col-md-7">
			<h2 class="featurette-heading">Connecting to a PC</h2>
			<p class="lead">Most music software supports contollers using the MIDI interface - unfortunately we only have access to a serial port using USB so a couple of utilities are required to trick the operating system to thinking we have a real MIDI device.</p>

			<p class="lead"><a href="http://nerds.de/en/loopbe1.html">LoopBe1:</a> Creates a fake MIDI port which music software can listen to.</p>
			<p class="lead"></p>

			<p class="lead"><a href="http://projectgus.github.io/hairless-midiserial/">Hairless MIDI:</a> Reads a serial port and converts messages to MIDI which LoopBe1 can read</p>
			<p class="lead"></p>

        </div>
        <div class="col-md-5">
          <img class="featurette-image img-responsive center-block" height="500" width="500" src="assets/dj/13-1.png" alt="Generic placeholder image">
        </div>
      </div>
      <hr class="featurette-divider">

      <div class="row featurette">
        <div class="col-md-7">
			<h2 class="featurette-heading">Configuring Mixxx</h2>
			<p class="lead">Mapped the MIDI controls to various controls in Mixxx.</p>
			<p class="lead">The mapping file can be found <a href="assets/dj/mixxx.xml">here</a></p>

        </div>
        <div class="col-md-5">
          <img class="featurette-image img-responsive center-block" height="500" width="500" src="assets/dj/13-2.png" alt="Generic placeholder image">
        </div>
      </div>
      <hr class="featurette-divider">

      <hr class="divider">
      <h1 class="featurette-title">All working together</h1>
      <hr class="divider">

      <div class="row featurette">
       	<img class="featurette-image img-responsive center-block" src="assets/dj/14.jpg" alt="Generic placeholder image">
      </div>
      <hr class="featurette-divider">

      

      

      <!-- /END THE FEATURETTES -->


      <!-- FOOTER -->
      <footer>
        
        <a href="https://twitter.com/fatcoookies"><img width=32px src="assets/twitter.png"></img></a>
        <a href="https://www.facebook.com/bob.dinkle"><img width=32px src="assets/facebook.png"></img></a>
        <a href="https://github.com/fatcookies"><img width=32px src="assets/github.png"></img></a>
        <a href="https://www.linkedin.com/in/adam-piekarski-a678a1b9"><img width=32px src="assets/linkedin.png"></img></a></p>

        <p class="pull-right"><a id="toplink" href="#">Back to top</a> 
        <p>&copy; 2015-2020 Adam Piekarski. &middot; <a href="#">Privacy</a> &middot; <a href="#">Terms</a></p>
      </footer>

    </div><!-- /.container -->


    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
    <script>

  var mainbottom = $('#myCarousel').offset().top + $('#myCarousel').height();

    // on scroll, 
    $(window).on('scroll',function(){

    // we round here to reduce a little workload
    stop = Math.round($(window).scrollTop());
    if (stop > mainbottom) {
          $('.navbar').addClass('nav-up');
        
    } else {
          $('.navbar').removeClass('nav-up');
    }

    });
        function scrollToAnchor(aid){
    var aTag = $("a[name='"+ aid +"']");
    $('html,body').animate({scrollTop: aTag.offset().top},'slow');
    }

  $("#toplink").click(function() {
     scrollToAnchor('toptop');
  });
    </script>

    <script src="js/bootstrap.min.js"></script>
  </body>
</html>
